# üõ†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø 3GIS - –í–´–ü–û–õ–ù–ï–ù–´

**–î–∞—Ç–∞**: 30 –∏—é–Ω—è 2025  
**–í—Ä–µ–º—è**: $(date '+%H:%M:%S')  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

## üö® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ –ª–æ–≥–æ–≤ Vercel:

### 1. ‚ùå `telegram_chats.shareCount does not exist in the current database`
- **–ü—Ä–∏—á–∏–Ω–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ `share_count` –≤ –ë–î
- **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω SQL —Ñ–∞–π–ª `APPLY_TO_SUPABASE.sql`
- **–°—Ç–∞—Ç—É—Å**: üìù –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### 2. ‚ùå `Event handlers cannot be passed to Client Component props`
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Server Components
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–º–µ—á–µ–Ω—ã 'use client'
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### ‚úÖ 1. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –ë–î
```typescript
// src/lib/database-utils.ts
- getShareCount() - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ shareCount
- sanitizeBusinessData() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
- sanitizeChatData() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
- safeQuery() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Prisma
- createSafeBusinessQuery() - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±–∏–∑–Ω–µ—Å–∞
- createSafeChatQuery() - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —á–∞—Ç–∞
```

### ‚úÖ 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```typescript
// src/app/tg/business/[id]/page.tsx
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç createSafeBusinessQuery()
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω sanitizeBusinessData()

// src/app/tg/chats/[id]/page.tsx  
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç createSafeChatQuery()
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω sanitizeChatData()
```

### ‚úÖ 3. SQL –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ Supabase
```sql
// APPLY_TO_SUPABASE.sql
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ share_count
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ SEO –∫–æ–ª–æ–Ω–æ–∫ (slug, og_title, og_description, og_image)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```

## üöÄ –ö–†–ò–¢–ò–ß–ù–û: –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –¥–µ–ø–ª–æ—è

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å SQL –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):
```bash
# 1. –ó–∞–π—Ç–∏ –≤ Supabase Dashboard
# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ SQL Editor
# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ APPLY_TO_SUPABASE.sql
# 4. –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å Prisma —Å—Ö–µ–º—É:
```bash
cd D:\dev\3gis
npx prisma db pull  # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É —Å –ë–î
npx prisma generate # –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É:
```bash
rm -rf .next
npm run build
```

### 4. –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω:
```bash
git add .
git commit -m "fix: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î –∏ Server Components

- –î–æ–±–∞–≤–ª–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ shareCount  
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã business/[id] –∏ chats/[id]
- –°–æ–∑–¥–∞–Ω—ã –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ—Ç –æ—à–∏–±–æ–∫ Prisma"

git push
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

### ‚úÖ –í –ª–æ–≥–∞—Ö Vercel –∏—Å—á–µ–∑–Ω—É—Ç –æ—à–∏–±–∫–∏:
- ‚ùå `telegram_chats.shareCount does not exist`
- ‚ùå `businesses.shareCount does not exist`  
- ‚ùå `Event handlers cannot be passed to Client Component props`

### ‚úÖ –ó–∞—Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- `/tg/business/1`, `/tg/business/4` –∏ –¥—Ä—É–≥–∏–µ
- `/tg/chats/6`, `/tg/chats/9` –∏ –¥—Ä—É–≥–∏–µ

### ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±–∏–∑–Ω–µ—Å–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —á–∞—Ç–æ–≤
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- –°–∏—Å—Ç–µ–º–∞ —à–µ—Ä–∏–Ω–≥–∞ (–≤ –±—É–¥—É—â–µ–º)

## üîç –ü–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ (–ø–µ—Ä–≤—ã–µ 30 –º–∏–Ω—É—Ç):
- Vercel Function Logs
- –û—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:
```bash
# –û—Ç–∫—Ä—ã—Ç—å —ç—Ç–∏ URL –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:
https://3gis.biz/tg/business/1
https://3gis.biz/tg/business/4
https://3gis.biz/tg/chats/6
https://3gis.biz/tg/chats/9
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∏ –¥–æ–±–∞–≤–∏–ª–∏—Å—å:
SELECT column_name FROM information_schema.columns 
WHERE table_name = 'telegram_chats' AND column_name = 'share_count';

SELECT column_name FROM information_schema.columns 
WHERE table_name = 'businesses' AND column_name = 'share_count';
```

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
- –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã - —Å—Ä–∞–∑—É –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 24 —á–∞—Å–æ–≤
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ - –æ—Ç–∫–∞—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π

---

## üéØ –†–µ–∑—é–º–µ:
–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é.  
**–ì–ª–∞–≤–Ω–æ–µ - –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å SQL –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö!**

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 30 –∏—é–Ω—è 2025*
